============================
Installing KPP-for-GEOS-Chem
============================

Once you have made sure that your system meets all the :ref:`System
Requirements`, you may download and install KPP-for-GEOS-Chem.

-----------
Downloading
-----------

Use this command to download the KPP-for-GEOS-Chem source code from the ``GC_updates`` branch
of the `KPP Github repository <https://github.com/geoschem/KPP>`__:

.. code-block:: console

  git clone -b GC_updates https://github.com/geoschem/KPP.git

.. important:: Do not download the KPP-for-GEOS-Chem source code into your
	       GEOS-Chem source code directory! This will avoid
	       confusion with the KPP folder within GEOS-Chem.

	       The KPP folder within the GEOS-Chem source code
	       contains the Fortran-90 files that were generated by
	       KPP-for-GEOS-Chem. These files define the chemical
	       mechanism that will be used in GEOS-Chem simulations.

.. tip:: If you wish to use KPP to generate chemical mechanisms for a
	 standalone chemical box model instead of for GEOS-Chem, then
	 download the code from the ``main`` branch instead of from
	 ``GC_updates``.  This will give you the unmodified KPP
	 version 2.2.3_01.

---------
Compiling
---------

Build the KPP-for-GEOS-Chem executable file with these commands:

.. code-block:: console

  cd KPP/kpp-code
  make distclean
  make all

If the build completes successfully, you will see the executable file ``KPP/kpp-code/bin/kpp``.

----------------
Setting the path
----------------

Once have built KPP-for-GEOS-Chem, you must add the path to the
executable file to your ``PATH`` environment variable.

If you use the bash Unix shell, add these lines to your
``~/.bash_aliases`` file.  If you don't have a
``~/.bash_aliases`` file, you can add these lines to your
``~/.bashrc`` file instead.)

.. code-block:: console

  export PATH=$PATH:/PATH_TO_KPP/KPP/kpp-code/bin/
  export KPP_HOME=PATH_TO_KPP/KPP/kpp-code

If you use the csh or tcsh Unix shell, add these lines to your
``~/.cshrc`` file:

.. code-block:: console

  setenv PATH $PATH:/PATH_TO_KPP/KPP/kpp-code/bin/
  setenv KPP_HOME=PATH_TO_KPP/KPP/kpp-code

.. note:: 

  - For example, if you installed FlexChem-KPP into your home
    directory, then  ``PATH_TO_KPP`` would be ``~/KPP``, etc.
    
